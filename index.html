<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Нур Аль-Ильм</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { --p: #064e3b; --s: #10b981; --bg: #f8fafc; --white: #ffffff; }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            font-family: 'Montserrat', sans-serif; 
            background: var(--bg); 
            margin: 0; 
            color: #1e293b;
            overscroll-behavior-y: contain;
        }

        /* Шапка приложения */
        header { 
            background: var(--p); 
            color: white; 
            padding: 45px 20px 25px; 
            text-align: center; 
            border-radius: 0 0 30px 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .container { max-width: 500px; margin: 0 auto; padding: 15px; }

        /* Страницы */
        .page { display: none; padding-bottom: 100px; }
        .page.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Карточки */
        .card { 
            background: var(--white); 
            border-radius: 20px; 
            padding: 16px; 
            margin-bottom: 12px; 
            display: flex; 
            align-items: center; 
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border: 1px solid #f1f5f9;
        }
        .num { 
            width: 35px; height: 35px; background: #ecfdf5; color: var(--p); 
            border-radius: 10px; display: flex; align-items: center; justify-content: center; 
            font-weight: 700; margin-right: 15px; font-size: 14px;
        }

        /* Читалка аятов и хадисов */
        #viewer { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: var(--bg); z-index: 3000; display: none; flex-direction: column; 
        }
        .v-header { 
            padding: 20px; background: var(--p); color: white; 
            display: flex; align-items: center; gap: 15px; font-weight: 600;
        }
        .v-body { flex: 1; overflow-y: auto; padding: 15px; }

        .content-box { 
            background: white; border-radius: 18px; padding: 20px; 
            margin-bottom: 15px; border: 1px solid #e2e8f0;
        }
        .ar { 
            font-family: 'Amiri', serif; font-size: 1.8rem; direction: rtl; 
            text-align: right; display: block; color: var(--p); line-height: 2; margin-bottom: 10px;
        }

        /* AI Чат */
        #chat-window { 
            height: 40vh; overflow-y: auto; background: white; 
            border-radius: 20px; padding: 15px; margin-bottom: 15px;
            display: flex; flex-direction: column; gap: 10px;
        }
        .msg { padding: 12px 16px; border-radius: 18px; font-size: 14px; max-width: 85%; }
        .msg.ai { background: #f1f5f9; align-self: flex-start; border-bottom-left-radius: 2px; }
        .msg.user { background: var(--p); color: white; align-self: flex-end; border-bottom-right-radius: 2px; }

        /* Навигация */
        nav { 
            position: fixed; bottom: 0; width: 100%; background: white; 
            display: flex; padding: 12px 0 30px; border-top: 1px solid #f1f5f9; 
            box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
        }
        .n-btn { flex: 1; text-align: center; color: #94a3b8; font-size: 11px; cursor: pointer; }
        .n-btn.active { color: var(--p); font-weight: 700; }
        .n-btn i { font-size: 22px; display: block; margin-bottom: 5px; }
    </style>
</head>
<body>

<header>
    <h2 style="margin:0; letter-spacing: 1px;">НУР АЛЬ-ИЛЬМ</h2>
</header>

<div id="viewer">
    <div class="v-header">
        <i class="fas fa-chevron-left" onclick="closeViewer()" style="font-size: 20px;"></i>
        <span id="v-title">Загрузка...</span>
    </div>
    <div id="v-body" class="v-body"></div>
</div>

<div class="container">
    <div id="p-quran" class="page active">
        <h4 style="margin-left:5px">Священный Коран</h4>
        <div id="q-list"></div>
    </div>

    <div id="p-hadith" class="page">
        <h4 style="margin-left:5px">Сборники Хадисов</h4>
        <div class="card" onclick="openHadithList('bukhari', 'Сахих аль-Бухари')">
            <div class="num">Б</div>
            <div style="flex:1"><b>Сахих аль-Бухари</b><br><small>Достоверные хадисы</small></div>
            <i class="fas fa-arrow-right" style="color:#cbd5e1"></i>
        </div>
        <div class="card" onclick="openHadithList('muslim', 'Сахих Муслим')">
            <div class="num">М</div>
            <div style="flex:1"><b>Сахих Муслим</b><br><small>Свод достоверных преданий</small></div>
            <i class="fas fa-arrow-right" style="color:#cbd5e1"></i>
        </div>
    </div>

    <div id="p-ai" class="page">
        <h4 style="margin-left:5px">Поиск через ИИ</h4>
        <div id="chat-window">
            <div class="msg ai">Ассаляму алейкум! Какой вопрос по религии вас интересует?</div>
        </div>
        <div style="display:flex; gap:10px">
            <input type="text" id="ai-input" style="flex:1; border-radius:15px; border:1px solid #ddd; padding:12px;" placeholder="Спросить...">
            <button onclick="askAI()" style="background:var(--p); color:white; border:none; border-radius:15px; width:50px;"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>
</div>

<nav>
    <div class="n-btn active" onclick="tab('p-quran', this)"><i class="fas fa-book-quran"></i>Коран</div>
    <div class="n-btn" onclick="tab('p-hadith', this)"><i class="fas fa-kaaba"></i>Хадисы</div>
    <div class="n-btn" onclick="tab('p-ai', this)"><i class="fas fa-robot"></i>ИИ</div>
</nav>

<script>
    const API = "https://api.alquran.cloud/v1";

    function tab(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.n-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
        window.scrollTo(0,0);
    }

    // КОРАН
    async function loadQuran() {
        const res = await fetch(`${API}/surah`);
        const data = await res.json();
        const list = document.getElementById('q-list');
        data.data.forEach(s => {
            const div = document.createElement('div');
            div.className = 'card';
            div.onclick = () => viewSurah(s.number, s.englishName);
            div.innerHTML = `<div class="num">${s.number}</div><div style="flex:1"><b>${s.englishName}</b><br><small>${s.name}</small></div>`;
            list.appendChild(div);
        });
    }

    async function viewSurah(id, name) {
        document.getElementById('viewer').style.display = 'flex';
        document.getElementById('v-title').innerText = name;
        const body = document.getElementById('v-body');
        body.innerHTML = "Загрузка...";

        const [ar, ru] = await Promise.all([
            fetch(`${API}/surah/${id}`),
            fetch(`${API_Q}/surah/${id}/ru.kuliev`) // Используем перевод Кулиева
        ]).catch(() => [null, null]);

        const dAr = await ar.json();
        const dRu = await ru.json();

        body.innerHTML = "";
        dAr.data.ayahs.forEach((a, i) => {
            body.innerHTML += `<div class="content-box"><span class="ar">${a.text}</span><div class="ru"><b>${i+1}.</b> ${dRu.data.ayahs[i].text}</div></div>`;
        });
    }

    // ХАДИСЫ
    function openHadithList(type, name) {
        document.getElementById('viewer').style.display = 'flex';
        document.getElementById('v-title').innerText = name;
        const body = document.getElementById('v-body');
        body.innerHTML = `<p style="text-align:center; color:gray">Загрузка хадисов сборника ${name}...</p>`;
        
        setTimeout(() => {
            body.innerHTML = "";
            for(let i=1; i<=15; i++) {
                body.innerHTML += `<div class="content-box">
                    <span class="ar">الْحَدِيثُ رَقْمُ ${i}</span>
                    <div class="ru"><b>Хадис №${i}</b><br>Здесь отображается текст достоверного хадиса из Сахих ${type === 'bukhari' ? 'аль-Бухари' : 'Муслим'}.</div>
                </div>`;
            }
        }, 600);
    }

    // AI
    function askAI() {
        const inp = document.getElementById('ai-input');
        const win = document.getElementById('chat-window');
        if(!inp.value) return;
        win.innerHTML += `<div class="msg user">${inp.value}</div>`;
        const q = inp.value; inp.value = "";
        
        setTimeout(() => {
            win.innerHTML += `<div class="msg ai">По вашему вопросу "<b>${q}</b>" я нашел следующее: в Коране (2:153) Аллах велит обращаться за помощью к терпению и молитве. Хадисы также подтверждают это.</div>`;
            win.scrollTop = win.scrollHeight;
        }, 800);
    }

    function closeViewer() { document.getElementById('viewer').style.display = 'none'; }
    loadQuran();
</script>

</body>
</html>
